blueprint {

   streamlets {

     # generator
     transaction-generator = cloudflow.examples.frauddetection.ingress.GenerateTransactions

     # http endpoint for accepting transactions
     transactions-over-http = cloudflow.examples.frauddetection.ingress.ReceiveTransactionsOverHttp

     # merging sources of transactions
     merge-sources = cloudflow.examples.frauddetection.process.MergeTransactions

     # splitter
     split-on-merchant = cloudflow.examples.frauddetection.process.SplitOnApprovedMerchant

     # here's where the real work gets done!
     fraud-detection = cloudflow.examples.frauddetection.process.ScoreTransactionsAndServeModels

     # log it!
     log-transactions = cloudflow.examples.frauddetection.egress.LogCustomerTransactions

     # Spark Aggregation
     fraud-report = cloudflow.examples.frauddetection.process.FraudPerMerchantPerMonth

     # log aggregation results
     log-fraud-report = cloudflow.examples.frauddetection.egress.LogFraudReport
   }

   connections {
     transaction-generator.transactions = [merge-sources.left]
     transactions-over-http.transactions = [merge-sources.right]
     merge-sources.transactions = [split-on-merchant.in]
     split-on-merchant.yes = [log-transactions.merchant]
     split-on-merchant.no = [fraud-detection.transactions]
     fraud-detection.results = [log-transactions.model, fraud-report.in]
     fraud-report.out = [log-fraud-report.in]
   }
 }
